<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhập Dữ liệu Tăng ca</title>
    <style>
        /* (Existing styles remain unchanged) */
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>

    <!-- Màn hình Đăng Nhập -->
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <h2>Đăng Nhập</h2>
            <label for="password">Mật khẩu:</label>
            <input type="password" id="password" placeholder="Nhập mật khẩu" required>
            <button onclick="checkPassword()">Đăng Nhập</button>
            <div id="login-message" style="color: red; text-align: center;"></div>
        </div>
    </div>

    <!-- Màn hình chính (ẩn lúc đầu) -->
    <div id="main-screen" class="container" style="display: none;">
        <h1>Nhập Dữ liệu Tăng ca</h1>
        <form id="overtimeForm">
            <!-- (Existing form fields remain unchanged) -->
            <button type="submit">Nhập Dữ liệu</button>
            <div class="form-message" id="formMessage"></div>
        </form>

        <div id="current-time"></div>
        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTsT_bGLLTA96c3YEM7PFUloRXX4mEcVsfCiD8wLEUH6GRRHvSd2JZBuZxlRhIGuSXpZbFkcGR2Qr2r/pubhtml#" class="access-link">Truy Cập Google Sheets</a> 
        <h2>Dữ liệu từ Excel</h2>
        <table id="excel-table"></table>
    </div>

    <script>
        let isDisabled = false;

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = '110405';  // Replace this with your desired password
            const loginMessage = document.getElementById('login-message');
            
            if (passwordInput === correctPassword) {
                document.getElementById('login-screen').style.display = 'none'; // Hide login screen
                document.getElementById('main-screen').style.display = 'block'; // Show main screen
                updateTime(); // Show real-time clock
                renderExcelData(); // Show Excel data
            } else {
                isDisabled = true;
                loginMessage.textContent = 'Mật khẩu không đúng. Vui lòng thử lại.';
            }
        }

        function updateTime() {
            // (Existing function to update time)
        }

        function renderExcelData() {
            // (Existing function to fetch and render Excel data)
        }

        document.getElementById('overtimeForm').addEventListener('submit', function(event) {
            if (isDisabled) {
                event.preventDefault();
                document.getElementById('formMessage').textContent = 'Chương trình đã bị vô hiệu hóa do nhập sai mật khẩu.';
                return;
            }
            
            event.preventDefault();
            const webhookUrl = 'https://hook.us2.make.com/r55ahr3g7nqakgcwqcre7wm2v2j2uvl7#'; // Replace with your webhook URL
            const formData = new FormData(event.target);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => {
                if (response.ok) {
                    alert('Dữ liệu đã được nhập thành công!');
                    event.target.reset();
                } else {
                    alert('Có lỗi xảy ra khi nhập dữ liệu.');
                }
            })
            .catch(error => {
                alert('Có lỗi xảy ra: ' + error.message);
            });
        });
    </script>
</body>
</html>
